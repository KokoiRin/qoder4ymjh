# Qt Demo 项目 - 高级窗口操作工具

这是一个模块化的Qt C++项目，提供窗口绑定、颜色拾取和点击模拟功能。

## 🏗️ 项目结构

```
QtDemo/
├── src/                    # 源文件目录
│   ├── main.cpp           # 程序入口点
│   ├── ui/                # UI相关源文件
│   │   └── MainWindow.cpp # 主窗口实现
│   ├── core/              # 核心功能模块
│   │   ├── WindowManager.cpp    # 窗口管理器
│   │   ├── ColorPicker.cpp      # 颜色拾取器
│   │   └── ClickSimulator.cpp   # 点击模拟器
│   └── utils/             # 工具类（预留）
│
├── include/               # 头文件目录
│   ├── ui/               # UI相关头文件
│   │   └── MainWindow.h  # 主窗口头文件
│   ├── core/             # 核心功能头文件
│   │   ├── WindowManager.h     # 窗口管理器头文件
│   │   ├── ColorPicker.h       # 颜色拾取器头文件
│   │   └── ClickSimulator.h    # 点击模拟器头文件
│   └── utils/            # 工具类头文件（预留）
│
├── CMakeLists.txt        # CMake构建配置
├── README.md            # 项目说明文档
└── build_instructions.md # 详细编译说明
```

## ✨ 功能特性

### 🎯 模块化设计
- **WindowManager**: 负责窗口枚举、绑定和管理
- **ColorPicker**: 提供实时颜色拾取功能
- **ClickSimulator**: 实现精确的鼠标点击模拟
- **MainWindow**: 统一的用户界面

### 🪟 窗口管理功能
- **智能窗口枚举**: 自动过滤工具窗口和隐藏窗口
- **详细窗口信息**: 显示标题、类名、句柄、位置、大小
- **安全窗口绑定**: 验证窗口有效性后绑定
- **实时状态检查**: 持续监控绑定窗口状态

### 🎨 颜色拾取功能
- **实时颜色预览**: 鼠标移动时即时显示颜色
- **多格式支持**: RGB和十六进制格式
- **可调更新频率**: 10-1000ms可调节
- **精确位置显示**: 显示屏幕坐标
- **交互式拾取**: 点击确认颜色选择

### 🖱️ 点击模拟功能（重点优化）
- **多坐标系统支持**:
  - 屏幕绝对坐标
  - 窗口相对坐标 
  - 客户区相对坐标
- **多鼠标按键支持**: 左键、右键、中键
- **点击类型支持**: 单击、双击
- **可调延迟设置**: 0-1000ms按键延迟
- **智能坐标转换**: 自动处理不同坐标系转换
- **可靠消息发送**: 使用Windows API直接发送消息
- **实时状态反馈**: 显示执行结果和错误信息

## 🚀 使用说明

### 窗口绑定流程
1. 启动程序
2. 点击"刷新列表"获取当前窗口
3. 从下拉菜单选择目标窗口
4. 点击"绑定窗口"完成绑定
5. 查看窗口详细信息

### 颜色拾取操作
1. 确保已绑定目标窗口
2. 可选：调整更新间隔
3. 点击"开始取色"进入拾取模式
4. 移动鼠标查看实时颜色
5. 左键点击确认颜色选择
6. 按ESC键或再次点击按钮退出

### 点击模拟操作（核心功能）
1. **绑定目标窗口**（必须）
2. **输入坐标**: 格式为 x,y（如：100,200）
3. **选择坐标类型**:
   - 屏幕坐标：相对于整个屏幕
   - 窗口坐标：相对于窗口左上角
   - 客户区坐标：相对于窗口客户区
4. **选择鼠标按键**: 左键/右键/中键
5. **可选设置**:
   - 勾选"双击"进行双击操作
   - 调整"延迟"设置按键延时
6. **执行点击**: 点击"执行点击"按钮
7. **查看结果**: 在状态栏查看执行结果

### 高级点击功能
- **置顶窗口**: 点击"置顶窗口"将目标窗口置于最前
- **坐标自动转换**: 程序自动处理坐标系转换
- **错误提示**: 详细的错误信息和解决建议

## 🛠️ 技术实现

### 点击模拟技术细节
```cpp
// 支持三种坐标类型
enum class CoordinateType {
    Screen,   // 屏幕绝对坐标
    Window,   // 窗口相对坐标 
    Client    // 客户区相对坐标
};

// 智能坐标转换
QPoint convertCoordinate(const QPoint& pos, 
                        CoordinateType fromType, 
                        CoordinateType toType);

// 精确点击实现
bool click(int x, int y, 
          CoordinateType coordType = CoordinateType::Screen,
          MouseButton button = MouseButton::Left,
          ClickType clickType = ClickType::Single);
```

## 🔧 编译环境

### 必需依赖
- **Qt6** (推荐6.5+)
- **CMake** 3.16+
- **C++17**编译器
- **Windows API** (user32.lib, gdi32.lib)

### CLion配置
1. 打开CLion
2. 选择"Open"打开项目文件夹
3. 等待CMake配置完成
4. 如需要，在CMake选项中添加Qt路径：
   ```
   -DCMAKE_PREFIX_PATH="C:/Qt/6.5.0/msvc2019_64"
   ```
5. 编译运行

## 🎯 未来扩展

项目采用模块化设计，便于添加新功能：
- 键盘输入模拟
- 图像识别和匹配
- 自动化脚本录制
- 窗口截图功能
- 更多坐标系统支持

## 📝 注意事项

1. **权限要求**: 某些系统窗口可能需要管理员权限
2. **兼容性**: 主要针对Windows平台设计
3. **安全性**: 仅对绑定的目标窗口进行操作
4. **性能**: 颜色拾取频率可根据需要调整

## 在CLion中配置和运行

### 前置要求
1. 确保已安装Qt6（推荐Qt 6.2或更高版本）
2. 确保CLion能找到Qt安装路径

### 在CLion中打开项目
1. 打开CLion
2. 选择 "Open" 或 "File" -> "Open"
3. 选择包含 `CMakeLists.txt` 的项目文件夹
4. CLion会自动检测CMake项目并配置

### 配置Qt路径（如果需要）
如果CLion无法自动找到Qt：
1. 转到 "File" -> "Settings" (Windows/Linux) 或 "CLion" -> "Preferences" (macOS)
2. 导航到 "Build, Execution, Deployment" -> "CMake"
3. 在CMake选项中添加：`-DCMAKE_PREFIX_PATH="你的Qt安装路径"`
   例如：`-DCMAKE_PREFIX_PATH="C:/Qt/6.5.0/msvc2019_64"`

### 编译和运行
1. 在CLion中打开项目后，等待CMake配置完成
2. 选择构建目标（通常是 "QtDemo"）
3. 点击绿色的运行按钮或按 Shift+F10
4. 项目将编译并启动，显示Qt窗口

## 预期行为
- 启动后会显示一个400x300像素的窗口
- 窗口中央有一个"点击我!"按钮
- 点击按钮会弹出消息框显示"你点击了按钮！"